<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
<title>freeflow documentation</title>
<link href="surfit.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<h1><a class="anchor" name="example">freeflow examples</a></h1><dl compact><dt><b>Two main ways of pressure fields reconstruction</b></dt><dd></dd></dl>
There are two widely-used ways of solving pressure reconstruction problem: <ul>
<li>Interpolation of the so-called "formation pressures", pressures measured in wells after two or three days of shut-down.</li>
</ul>
<ul>
<li>Creation of the mathematical model describing fluid filtration using the language of partial differential equations.</li>
</ul>
Due to the simplicity of usage, the first way is much more widely used PU (performance unit): there is no necessity in model tuning and algorithms are simply to use. Obtained pressure field is often physically inadequate, nevertheless it is used to analyze energy state of oil formation, to detect boundaries of reduced and raised pressure zones and calculate weighted average pressures within areas. The second way is usually used in research institutes and model creation is well-expensive. Usually it takes about one year. The significant constraint involuntarily set up to mathematical models described by the terms of partial differential equations is connected with the correctness of a boundary problem. For example, to describe a well in mathematical model we set only fluid rate/injectivity or bottom hole pressure. The simultaneous setting of rates and pressures may lead to incorrect (overdetermined) boundary problem. However, the simultaneous setting of inconsistent data is frequent for solving of underground fluid filtration problems - there is a lot of inconsistent data with different levels of errors. Existent mathematical models require precise data with no errors (rates, pressures, permeability), but it is impossible in the real life. That's why the ability of mathematical model to take into account inconsistent data and data with errors is of high-interest for authors.<p>
This example shows the method, which has the features of the both considered ways and has the ability to take into account often inconsistent values of rates and bottom hole pressures in wells.<p>
<dl compact><dt><b>Classical statement of the problem in the differential form.</b></dt><dd></dd></dl>
We are considering the task of calculating an isobar map for a homogeneous productive oil formation with a relatively small thickness <img class="formulaInl" alt="$h$" src="form_0.png">. In this case the function <img class="formulaInl" alt="$u(x,y)$" src="form_1.png"> of the formation pressure can be considered two-dimensional. <img class="formulaInl" alt="$u(x,y)$" src="form_1.png"> is obtained by solving the boundary problem: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{k}{\mu} \Delta u = \sum_{i=1}^N Q_i \delta(P-P_i) + \sum_{j=1}^M \int\limits_{l_j} S_j(l) \delta(P-l) dl, \]" src="form_2.png">
<p>
 where $k$ is permeability, $$ - liquid viscosity. The vertical wells are described as point sources with flowrates of $Q_i$. The position of horizontal (slanting) wells and formation fractures is described by a curve with the curved source density of $S_j$. The boundary conditions are:<p>
<ul>
<li><img class="formulaInl" alt="$u|_{\Gamma}=u_0$" src="form_3.png"> - value of pressure on the boundary (oil bearing outer contour);</li>
</ul>
<ul>
<li><img class="formulaInl" alt="$u(P_k)=u_k, \ k=1,\ldots,K$" src="form_4.png"> - downhole pressures;</li>
</ul>
<ul>
<li><img class="formulaInl" alt="$\nabla u \cdot n_{l_f} = 0 |_{l_f}, \ f=1,\ldots,F$" src="form_5.png"> - condition of non-filtration on the curves (boundaries of non-productive formations, tectonic zones).</li>
</ul>
For a differential equation of elliptical type the simultaneous setting of rates and pressures for the same points and/or curves of the area is incorrect but it is frequent when the formation energy state is studied. In order to use the overdetermined conditions and avoid the incorrectness the boundary problem is re-formulated as a variational problem.<p>
<dl compact><dt><b>Variational statement of the problem.</b></dt><dd></dd></dl>
The pressure field is determined as cells of equidistant grid with values: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ u(x,y) = \sum_{i=1}^N \sum_{j=1}^M u_{i,j} \phi_{i,j}(x,y) \]" src="form_6.png">
<p>
 For each cell we can write one of the two functionals:<p>
<ul>
<li>Pressure in the cell: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ P_{i,j} = \sum\limits_{p = 1}^P {\alpha _p \left( {u_{i,j} - u_p } \right)^2 } = \min \]" src="form_7.png">
<p>
 This functional describes the way of taking into account pressures of the wells, which belong to the (i,j) cell. Differentiation of this functional by <img class="formulaInl" alt="$u_{i,j}$" src="form_8.png"> leads to the equation: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{i,j} = \frac{{\sum\limits_{p = 1}^P {\alpha _p u_p } }}{{\sum\limits_{p = 1}^P {\alpha _p } }} \]" src="form_9.png">
<p>
</li>
</ul>
<ul>
<li>Cell rate: we use well-known variational principle describing filtration in porous medium: among all possible isothermal laminar flows of homogeneous incompressible liquid in cell with heterogeneous borders with filtration speed set, the real filtration flow is that the pressure forces work spent for filtration resistance is minimal.</li>
</ul>
For work of pressure forces in the cell we can write: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_{i,j} = \frac{1}{2}\bar F_{i,j} \cdot \bar v_{i,j} - \frac{{q_{i,j} }}{{\rho _{i,j} }}u_{i,j} = \min \]" src="form_10.png">
<p>
 Differentiation of this expression by <img class="formulaInl" alt="$u_{i,j}$" src="form_8.png"> leads to law of conservation of mass written for the cell (i,j). To represent impermeable lines it is necessary to set zero filtration speed via suitable cell borders. It is effective to use Brezengham algorithm for that.<p>
CMOFS algorithm considers 3 situations:<p>
<ul>
<li>We know exact pressure for the cell. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{ \begin{array}{l} P_{i,j} = \min , \\ A_{i,j} = \min . \\ \end{array} \right. \]" src="form_11.png">
<p>
 The functional describing pressure is the first to be minimized, the functional describing rate is the second.</li>
</ul>
<ul>
<li>We know exact cell rate and permeable cell borders. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left\{ \begin{array}{l} A_{i,j} = \min , \\ P_{i,j} = \min . \\ \end{array} \right. \]" src="form_12.png">
<p>
 The functional describing rate is the first to be minimized, the functional describing pressure is the second.</li>
</ul>
<ul>
<li>We know cell debit with permeable cell borders and pressure for the cell. When we minimize combination of functionals: <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta A_{i,j} + P_{i,j} = \min, \]" src="form_13.png">
<p>
 where <img class="formulaInl" alt="$beta$" src="form_14.png"> determines degree of reliability for each of the functionals.</li>
</ul>
In case if we use only 1 and 2 types of functionals to obtain the solution, the solution will be the same as for corresponding boundary problem because we use only consistent data. In case of redundant and inconsistent data we use the third functional. <P align="center">
<BR>
<TT>freeflow-1.0.0pre</TT>
<BR>
</P>

