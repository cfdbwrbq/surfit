<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
<title>surfit documentation</title>
<link href="surfit.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>map_task.tcl</h1>This example shows how one goes from randomly spaced data points to an evenly sampled surface. We have 13504 interpolation points (file <code>surfit/examples/test/task.txt</code>) and equidistant grid with more than 1000000 nodes! To produce interpolation evenly sampled surface we do the following things: <ul>
<li>load scattered points to the memory </li>
<li>create equidistant grid of 1024x1024 nodes </li>
<li>set some additional parameters (<a class="el" href="group__surfit__variables.html#ga1">tolerance</a>, <a class="el" href="group__surfit__data__variables.html#ga2">surface behaviour between scattered points</a>) </li>
<li>run CMOFS algorithm </li>
<li>save results to file</li>
</ul>
After gridding we calculate residuals in interpolation points, mean residual value and standart deviation. To make residuals smaller it is necessary to make equidistant grid with smaller cells.<p>
Here is image of resulting surface:<p>


<P ALIGN=CENTER>
<IMG alt="interpolation surface" src="../../../gallery/maps/map_task_full.gif" border="0">
</P>
<P ALIGN=CENTER> Pic 1. interpolation surface </P>

<P ALIGN=CENTER>
<IMG alt="small part of interpolation surface" src="../../../gallery/maps/map_task.gif" border="0" ALIGN=ABSMIDDLE>
</P>
<P ALIGN=CENTER> Pic 2. small part of interpolation surface </P>

<p>
This result was obtained with <code>"surfit/examples/test/map_task.tcl"</code> script.<p>
Some comments to script: <ul>
<li><a class="el" href="group__surfit__variables.html#ga8">map_name</a> variable used to set name of resulting surface </li>
<li>we use <a class="el" href="group__surfit__variables.html#ga1">tol</a> variable to manage tolerance of iterative linear system solver algorithm. If this value is too big, iterative algorithm will make low number of iterations. It leads to rought result. </li>
<li><a class="el" href="group__tcl__grid__save__load.html#ga2">grid_unload</a> function call to remove grid from result file.</li>
</ul>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#</span>
<span class="preprocessor"></span>load libsurfit[info sharedlibextension]

<span class="preprocessor"># resulting surface must have name "map_task"</span>
<span class="preprocessor"></span>set <a class="code" href="group__surfit__variables.html#ga8">map_name</a> map_task

<span class="preprocessor"># reading scattered data points from 3-column text file</span>
<span class="preprocessor"></span><a class="code" href="group__tcl__task__save__load.html#ga1">task_read</a> task.txt task

<span class="preprocessor"># constructing surfit_grid</span>
<span class="preprocessor"></span><a class="code" href="group__tcl__grid__create.html#ga4">grid_get_for_task</a> 1024 1024

set <a class="code" href="group__surfit__variables.html#ga1">tol</a> 2e-6

<span class="preprocessor"># setting surface behaviour between scattered data points</span>
<span class="preprocessor"></span><a class="code" href="group__tcl__completer.html#ga0">completer_set</a> 1 2

<span class="preprocessor">## settings for very fast calculation (and unprepossessing result)</span>
<span class="preprocessor"></span><span class="preprocessor">#set tol 4e-6</span>
<span class="preprocessor"></span><span class="preprocessor">#completer_set 1 0</span>
<span class="preprocessor"></span>
<span class="preprocessor"># running CMOFS algorithm</span>
<span class="preprocessor"></span><a class="code" href="group__tcl.html#ga2">solve</a>

<span class="preprocessor"># unloading surfit_grid from memory</span>
<span class="preprocessor"></span><a class="code" href="group__tcl__grid__save__load.html#ga2">grid_unload</a>

<span class="preprocessor"># saving results to binary ROFF file</span>
<span class="preprocessor"></span><a class="code" href="group__tcl__file.html#ga2">file_save</a> map_task.dat

<a class="code" href="group__tcl__log.html#ga2">putlog</a> <span class="stringliteral">"calculating residuals..."</span>
<a class="code" href="group__tcl__func__math.html#ga1">func_resid</a> task_residuals.txt 

<a class="code" href="group__tcl__task__save__load.html#ga1">task_read</a> task_residuals.txt residuals 4 1 2 4
set <a class="code" href="group__tcl__task__math.html#ga12">task_mean</a> [task_mean]
<a class="code" href="group__tcl__log.html#ga2">putlog</a> <span class="stringliteral">"residuals mean value is $task_mean"</span>
<a class="code" href="group__tcl__log.html#ga2">putlog</a> <span class="stringliteral">"residuals standard deviation is [task_std $task_mean]"</span>
<a class="code" href="group__tcl__log.html#ga2">putlog</a> <span class="stringliteral">"func_D1 is [func_D1]"</span>

</pre></div> <P align="center">
<BR>
<TT>surfit-1.0.0pre</TT>
<BR>
</P>

