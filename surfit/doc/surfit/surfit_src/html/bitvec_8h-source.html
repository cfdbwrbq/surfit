<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=windows-1251">
<title>surfit documentation</title>
<link href="surfit.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="examples.html">Examples</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">surfit</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">src</a></div>
<h1>bitvec.h</h1><div class="fragment"><pre class="fragment">00001 
00002 <span class="comment">/*------------------------------------------------------------------------------</span>
00003 <span class="comment"> *      $Id$</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> *      Copyright (c) 2002-2004 by M. V. Dmitrievsky and V. N. Kutrunov</span>
00006 <span class="comment"> *      See COPYING file for copying and redistribution conditions.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> *      This program is free software; you can redistribute it and/or modify</span>
00009 <span class="comment"> *      it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment"> *      the Free Software Foundation; version 2 of the License.</span>
00011 <span class="comment"> *</span>
00012 <span class="comment"> *      This program is distributed in the hope that it will be useful,</span>
00013 <span class="comment"> *      but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00014 <span class="comment"> *      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00015 <span class="comment"> *      GNU General Public License for more details.</span>
00016 <span class="comment"> *</span>
00017 <span class="comment"> *      Contact info: surfit.sourceforge.net</span>
00018 <span class="comment"> *----------------------------------------------------------------------------*/</span>
00019 
00020 <span class="preprocessor">#ifndef __surfit_bitvec_included__</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#define __surfit_bitvec_included__</span>
00022 <span class="preprocessor"></span>
00023 <span class="preprocessor">#include &lt;math.h&gt;</span>
00024 <span class="preprocessor">#include &lt;memory.h&gt;</span>
00025 <span class="preprocessor">#include &lt;assert.h&gt;</span>
00026 
00027 <span class="keyword">namespace </span>surfit {
00028 
<a name="l00032"></a><a class="code" href="classsurfit_1_1bitvec.html">00032</a> <span class="keyword">class </span><a class="code" href="classsurfit_1_1bitvec.html">bitvec</a> {
00033 <span class="keyword">public</span>:
00034         
<a name="l00036"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca0">00036</a>         <a class="code" href="classsurfit_1_1bitvec.html">bitvec</a>(<span class="keywordtype">int</span> size = 0) {
00037                 <a class="code" href="classsurfit_1_1data.html">data</a> = NULL;
00038                 bits_per_byte = <span class="keyword">sizeof</span>(int)*8;
00039                 offset = (int)floor(log((<span class="keywordtype">double</span>)bits_per_byte)/0.693147180559945);
00040                 byte_size = (size + bits_per_byte - 1)/bits_per_byte;
00041                 <a class="code" href="classsurfit_1_1data.html">data</a> = (<span class="keywordtype">int</span>*)malloc(byte_size*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00042                 datasize = size;
00043         };
00044 
<a name="l00046"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca1">00046</a>         <a class="code" href="classsurfit_1_1bitvec.html">bitvec</a>(<span class="keyword">const</span> <a class="code" href="classsurfit_1_1bitvec.html">bitvec</a> * src) {
00047                 copy(src);
00048         }
00049 
<a name="l00051"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca2">00051</a>         ~<a class="code" href="classsurfit_1_1bitvec.html">bitvec</a>() {
00052                 free(<a class="code" href="classsurfit_1_1data.html">data</a>);
00053         };
00054 
<a name="l00056"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca3">00056</a>         <span class="keywordtype">bool</span> get(<span class="keywordtype">int</span> pos)<span class="keyword"> const </span>{
00057                 assert( (pos &gt;= 0) &amp;&amp; (pos &lt; datasize) );
00058                 <span class="keywordflow">return</span> ( *(<a class="code" href="classsurfit_1_1data.html">data</a> + (pos &gt;&gt; offset)) &amp; (1 &lt;&lt;(pos - ((pos &gt;&gt; offset)&lt;&lt;offset)))) != 0;
00059         };
00060 
<a name="l00062"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca4">00062</a>         <span class="keywordtype">void</span> set_true(<span class="keywordtype">int</span> pos) {
00063                 assert( (pos &gt;= 0) &amp;&amp; (pos &lt; datasize) );
00064                 *(<a class="code" href="classsurfit_1_1data.html">data</a> + (pos &gt;&gt; offset)) |= (1 &lt;&lt;(pos - ((pos &gt;&gt; offset)&lt;&lt;offset)));
00065         };
00066 
<a name="l00068"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca5">00068</a>         <span class="keywordtype">void</span> set_false(<span class="keywordtype">int</span> pos) {
00069                 assert( (pos &gt;= 0) &amp;&amp; (pos &lt; datasize) );
00070                 *(<a class="code" href="classsurfit_1_1data.html">data</a> + (pos &gt;&gt; offset)) &amp;=~ (1 &lt;&lt;(pos - ((pos &gt;&gt; offset)&lt;&lt;offset)));
00071         };
00072 
<a name="l00074"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca6">00074</a>         <span class="keywordtype">void</span> copy(<span class="keyword">const</span> <a class="code" href="classsurfit_1_1bitvec.html">bitvec</a> * src) {
00075                 <a class="code" href="classsurfit_1_1data.html">data</a> = NULL;
00076                 bits_per_byte = src-&gt;<a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco1">bits_per_byte</a>;
00077                 offset = src-&gt;<a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco2">offset</a>;
00078                 datasize = src-&gt;<a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco3">datasize</a>;
00079                 byte_size = src-&gt;<a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco4">byte_size</a>;
00080                 <a class="code" href="classsurfit_1_1data.html">data</a> = (<span class="keywordtype">int</span>*)malloc(byte_size*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00081                 memcpy(<a class="code" href="classsurfit_1_1data.html">data</a>, src-&gt;<a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco0">data</a>, byte_size*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
00082         }
00083 
<a name="l00085"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca7">00085</a>         <span class="keywordtype">void</span> init_false() {
00086                 <span class="keywordtype">int</span> i;
00087                 <span class="keywordtype">int</span> * ptr = <a class="code" href="classsurfit_1_1data.html">data</a>;
00088                 <span class="keywordflow">for</span> (i = 0; i &lt; byte_size; i++) {
00089                         *ptr = 0;
00090                         ptr++;
00091                 }
00092         };
00093 
<a name="l00095"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca8">00095</a>         <span class="keywordtype">void</span> init_true() {
00096                 <span class="keywordtype">int</span> i;
00097                 <span class="keywordflow">for</span> (i = 0; i &lt; size(); i++) 
00098                         set_true(i);
00099         };
00100 
<a name="l00102"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca9">00102</a>         <span class="keywordtype">int</span> size()<span class="keyword"> const </span>{
00103                 <span class="keywordflow">return</span> datasize;
00104         };
00105 
<a name="l00107"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca10">00107</a>         <span class="keywordtype">int</span> true_size()<span class="keyword"> const </span>{
00108                 <span class="keywordtype">int</span> i;
00109                 <span class="keywordtype">int</span> cnt = 0;
00110                 <span class="keywordflow">for</span> (i = 0; i &lt; datasize; i++) {
00111                         <span class="keywordflow">if</span> (get(i))
00112                                 cnt++;
00113                 }
00114                 <span class="keywordflow">return</span> cnt;
00115         };
00116 
<a name="l00118"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca11">00118</a>         <span class="keywordtype">void</span> write4(<span class="keywordtype">int</span> pos, 
00119                     <span class="keywordtype">bool</span> b1, <span class="keywordtype">bool</span> b2, <span class="keywordtype">bool</span> b3, <span class="keywordtype">bool</span> b4) 
00120         {
00121                 <span class="keywordtype">int</span> real_pos = pos*4;
00122                 
00123                 <span class="keywordflow">if</span> (b1)
00124                         set_true(real_pos);
00125                 <span class="keywordflow">else</span> 
00126                         set_false(real_pos);
00127                 real_pos++;
00128 
00129                 <span class="keywordflow">if</span> (b2)
00130                         set_true(real_pos);
00131                 <span class="keywordflow">else</span> 
00132                         set_false(real_pos);
00133                 real_pos++;
00134 
00135                 <span class="keywordflow">if</span> (b3)
00136                         set_true(real_pos);
00137                 <span class="keywordflow">else</span> 
00138                         set_false(real_pos);
00139                 real_pos++;
00140 
00141                 <span class="keywordflow">if</span> (b4)
00142                         set_true(real_pos);
00143                 <span class="keywordflow">else</span> 
00144                         set_false(real_pos);
00145         };
00146 
<a name="l00148"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca12">00148</a>         <span class="keywordtype">void</span> get4(<span class="keywordtype">int</span> pos, 
00149                   <span class="keywordtype">bool</span> &amp; b1, <span class="keywordtype">bool</span> &amp; b2, <span class="keywordtype">bool</span> &amp; b3, <span class="keywordtype">bool</span> &amp; b4) 
00150         {
00151                 <span class="keywordtype">int</span> real_pos = pos*4;
00152                 b1 = get(real_pos);
00153                 real_pos++;
00154                 b2 = get(real_pos);
00155                 real_pos++;
00156                 b3 = get(real_pos);
00157                 real_pos++;
00158                 b4 = get(real_pos);
00159         };
00160 
<a name="l00162"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca13">00162</a>         <span class="keywordtype">void</span> write10(<span class="keywordtype">int</span> pos, 
00163                      <span class="keywordtype">bool</span> b1, <span class="keywordtype">bool</span> b2, <span class="keywordtype">bool</span> b3, <span class="keywordtype">bool</span> b4, <span class="keywordtype">bool</span> b5,
00164                      <span class="keywordtype">bool</span> b6, <span class="keywordtype">bool</span> b7, <span class="keywordtype">bool</span> b8, <span class="keywordtype">bool</span> b9, <span class="keywordtype">bool</span> b10) 
00165         {
00166                 <span class="keywordtype">int</span> real_pos = pos*10;
00167                 
00168                 <span class="keywordflow">if</span> (b1)
00169                         set_true(real_pos);
00170                 <span class="keywordflow">else</span> 
00171                         set_false(real_pos);
00172                 real_pos++;
00173 
00174                 <span class="keywordflow">if</span> (b2)
00175                         set_true(real_pos);
00176                 <span class="keywordflow">else</span> 
00177                         set_false(real_pos);
00178                 real_pos++;
00179 
00180                 <span class="keywordflow">if</span> (b3)
00181                         set_true(real_pos);
00182                 <span class="keywordflow">else</span> 
00183                         set_false(real_pos);
00184                 real_pos++;
00185 
00186                 <span class="keywordflow">if</span> (b4)
00187                         set_true(real_pos);
00188                 <span class="keywordflow">else</span> 
00189                         set_false(real_pos);
00190                 real_pos++;
00191 
00192                 <span class="keywordflow">if</span> (b5)
00193                         set_true(real_pos);
00194                 <span class="keywordflow">else</span> 
00195                         set_false(real_pos);
00196                 real_pos++;
00197 
00198                 <span class="keywordflow">if</span> (b6)
00199                         set_true(real_pos);
00200                 <span class="keywordflow">else</span> 
00201                         set_false(real_pos);
00202                 real_pos++;
00203 
00204                 <span class="keywordflow">if</span> (b7)
00205                         set_true(real_pos);
00206                 <span class="keywordflow">else</span> 
00207                         set_false(real_pos);
00208                 real_pos++;
00209 
00210                 <span class="keywordflow">if</span> (b8)
00211                         set_true(real_pos);
00212                 <span class="keywordflow">else</span> 
00213                         set_false(real_pos);
00214                 real_pos++;
00215 
00216                 <span class="keywordflow">if</span> (b9)
00217                         set_true(real_pos);
00218                 <span class="keywordflow">else</span> 
00219                         set_false(real_pos);
00220                 real_pos++;
00221 
00222                 <span class="keywordflow">if</span> (b10)
00223                         set_true(real_pos);
00224                 <span class="keywordflow">else</span> 
00225                         set_false(real_pos);
00226                 
00227         };
00228 
<a name="l00230"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveca14">00230</a>         <span class="keywordtype">void</span> get10(<span class="keywordtype">int</span> pos, 
00231                    <span class="keywordtype">bool</span> &amp; b1, <span class="keywordtype">bool</span> &amp; b2, <span class="keywordtype">bool</span> &amp; b3, <span class="keywordtype">bool</span> &amp; b4, <span class="keywordtype">bool</span> &amp; b5,
00232                    <span class="keywordtype">bool</span> &amp; b6, <span class="keywordtype">bool</span> &amp; b7, <span class="keywordtype">bool</span> &amp; b8, <span class="keywordtype">bool</span> &amp; b9, <span class="keywordtype">bool</span> &amp; b10) 
00233         {
00234                 <span class="keywordtype">int</span> real_pos = pos*10;
00235                 b1 = get(real_pos);
00236                 real_pos++;
00237                 b2 = get(real_pos);
00238                 real_pos++;
00239                 b3 = get(real_pos);
00240                 real_pos++;
00241                 b4 = get(real_pos);
00242                 real_pos++;
00243                 b5 = get(real_pos);
00244                 real_pos++;
00245                 b6 = get(real_pos);
00246                 real_pos++;
00247                 b7 = get(real_pos);
00248                 real_pos++;
00249                 b8 = get(real_pos);
00250                 real_pos++;
00251                 b9 = get(real_pos);
00252                 real_pos++;
00253                 b10 = get(real_pos);
00254         };
00255 
<a name="l00257"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco0">00257</a>         <span class="keywordtype">int</span> * <a class="code" href="classsurfit_1_1data.html">data</a>;
00258 
<a name="l00260"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco1">00260</a>         <span class="keywordtype">int</span> bits_per_byte;
<a name="l00262"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco2">00262</a>         <span class="keywordtype">int</span> offset;
<a name="l00264"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco3">00264</a>         <span class="keywordtype">int</span> datasize;
<a name="l00266"></a><a class="code" href="classsurfit_1_1bitvec.html#surfit_1_1bitveco4">00266</a>         <span class="keywordtype">int</span> byte_size;
00267         
00268 };
00269 
00270 }; <span class="comment">// namespace surfit;</span>
00271 
00272 <span class="preprocessor">#endif</span>
00273 <span class="preprocessor"></span>
</pre></div><P align="center">
<BR>
<TT>surfit-1.0.0pre</TT>
<BR>
</P>

